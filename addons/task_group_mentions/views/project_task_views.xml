<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Add buttons to task form for manual group notifications -->
    <record id="view_task_form_inherit_group_mentions" model="ir.ui.view">
        <field name="name">project.task.form.group.mentions</field>
        <field name="model">project.task</field>
        <field name="inherit_id" ref="project.view_task_form2"/>
        <field name="arch" type="xml">
            <!-- Add buttons in header for manual notifications -->
            <xpath expr="//header" position="inside">
                <button name="action_notify_all_followers" 
                        type="object" 
                        string="Notify All" 
                        class="btn-secondary"
                        icon="fa-bullhorn"
                        help="Send notification to all followers"
                        groups="project.group_project_user"/>
                <button name="action_notify_board_members" 
                        type="object" 
                        string="Notify Board" 
                        class="btn-warning"
                        icon="fa-users"
                        help="Send notification to board members only"
                        groups="project.group_project_manager"/>
            </xpath>
            
            <!-- Add smart button for board members count -->
            <xpath expr="//div[@name='button_box']" position="inside">
                <field name="board_member_ids" invisible="1"/>
                <button class="oe_stat_button" 
                        icon="fa-user-tie"
                        type="object"
                        name="action_notify_board_members"
                        attrs="{'invisible': [('board_member_ids', '=', [])]}"
                        help="Board members following this task">
                    <field string="Board" 
                           name="board_member_ids" 
                           widget="statinfo"
                           options="{'label_field': 'name'}"/>
                </button>
            </xpath>
        </field>
    </record>

    <!-- Add help text in chatter -->
    <record id="view_task_form_inherit_chatter_help" model="ir.ui.view">
        <field name="name">project.task.form.chatter.help</field>
        <field name="model">project.task</field>
        <field name="inherit_id" ref="project.view_task_form2"/>
        <field name="arch" type="xml">
            <xpath expr="//div[@class='oe_chatter']" position="before">
                <div class="alert alert-info" role="alert" style="margin: 10px;">
                    <i class="fa fa-info-circle"/> <strong>Group Mentions:</strong>
                    Use <code>@all</code> to notify all followers or <code>@Vorstand</code> to notify board members only.
                </div>
            </xpath>
        </field>
    </record>
</odoo>